# 提示词

## 提示词基础概念

> 提示工程（Prompt engineering）是人工智能中的一个概念，特别是自然语言处理（NLP）。 在提示工程中，任务的描述会被嵌入到输入中。例如，不是隐含地给予模型一定的参数，而是以问题的形式直接输入。 提示工程的典型工作方式是将一个或多个任务转换为基于提示的数据集，并通过所谓的“基于提示的学习（prompt-based learning）”来训练语言模型。提示工程可以从一个大型的“冻结”预训练语言模型开始工作，其中只学习了提示的表示方法，即所谓的“前缀调整（prefix-tuning）”或“提示调整（prompt tuning）”。语言模型GPT-2和GPT-3是提示工程的重要步骤。

提示词分为正面提示词（Prompts）和反面提示词（Negative Prompts）。正面提示词代表你希望画面中出现的内容，反面提示词代表你不希望画面中出现的内容。 提示词的识别格式是英文书写，并不支持非英文的内容。提示词可以支持的最小单位是单词。

要生成一个穿着黄色衬衣的女孩。那么正向提示词为：

```prompt
1girl, yellow shirt,
```

在书写提示词时，建议通过词组进行组装，而非主从式的语句。通俗的讲：AI模型是通过多个标签矩阵进行绘画创作的。所以**主从式**的语句段落在AI绘画时得到的结果往往比**词组**的效果**差**很多。

举例：

- 主从式：
  - 一个穿着红色长裙的女孩站在夜晚的街道上，周围是闪烁的霓虹灯，天空中还飘着细雨。
  - A girl in a red long dress standing on a night street, surrounded by flickering neon lights, with a light drizzle falling from the sky.
- 词组：
  - 红色长裙女孩，夜晚街道，霓虹灯，细雨
  - girl in red long dress, night street, neon lights, light drizzle
  - 1girl, red long dress, night street, neon lights, light drizzle

Flex、SD 3.5 等模型可以使用主从式的提示词。

## 提示词的高阶技巧

以下通过实际案例介绍如何清晰、高效书写提示词。

### 提示词权重

> landscape, Norway, mountains, sea, fog, rain, 1 small wooden boat, jetty, outline of a sexy woman in a long white dress with complex golden details, long brown wavy hair, the woman stands on the boat, northern lights, Northern lights are reflected in the sea, vivid color, vivid background high contrast, stylized, clear, surreal, ultra quality , 8k, best quality, masterpiece, textural, artistic, midjourneyv6.1, on the boat,

![未增加“极光”权重](tex/ComfyUI_00044_.png) 

在所有参数不变的情况下，增加“极光”的权重。

从：

```prompt
northern lights,
```

改为：

```prompt
(northern lights: 1.2),
```

![增加“极光”权重](tex/ComfyUI_00046_.png)

可以看到极光的效果增强了。

> 提示词权重的作用：增加某个词组的在模型识别时的重要程度。

常用的提示词权重书写格式有两大类：

- 加括号：
  - `(northern lights),` 权重为 1.1
  - `((northern lights)),` 权重为 1.21，即 1.1 的二次方
  - 依此类推
- 数值控制：
  - `(northern lights: 1.2),`
  - `(northern lights: 0.5),`

权重高于 1，代表强调，低于 1，代表减弱。权重范围在 0.5 到 2.0 之间。

### 注释用法

> 1girl, (silver long hair), purple eyes, glasses, lipstick, (yellow business_suit:1.4), slim body, (walking), street_background, looking at viewer, (masterpiece:1. 4, best quality), unity 8k wallpaper, ultra detailed, beautiful and aesthetic, perfect lighting, detailed background, realistic, solo, perfect detailed face, detailed eyes, highly detailed,

![alt text](tex/ComfyUI_00051_.png)

可以发现，*紫色眼睛* `purple eyes` 污染了*黄色职业装* `(yellow business_suit:1.4)`。

原因是 `1girl, (silver long hair), purple eyes, glasses, lipstick, (yellow business_suit:1.4),` 对于模型来说是一个个独立的标签，相互的关联性全部依赖于模型自身的理解（模型在推算相互的关联是什么）。

在写提示词时需要通过一些手段让模型更好的理解词与词之间的关联性，使生成结果更准确。

注释用法：

```prompt
主体\(注释1,注释2\)
```

基于注释的方式，将提示词再一次优化：

> 1girl\\((silver long hair),purple eyes, glasses, lipstick, (yellow business_suit:1.4)\\), slim body, (walking:1.2), street_background, looking at viewer, full body shot,(masterpiece:1. 4, best quality), unity 8k wallpaper, ultra detailed, beautiful and aesthetic, perfect lighting, detailed background, realistic, solo, perfect detailed face, detailed eyes, highly detailed,

![alt text](tex/ComfyUI_00053_.png)

---

**参考：**

- [AI绘画：Stable Diffusion 提示词高阶用法（一）](https://zhuanlan.zhihu.com/p/645769166)